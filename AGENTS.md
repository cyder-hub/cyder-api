# AGENTS Guidelines
This repository is an AI proxy service. It provides a robust and scalable backend to handle various AI services.

## Tech Stack

### Frontend
* Base: solid-js, typescript
* UI: kobalte, tailwindcss
* Build: Node.js 24 (managed by xtask)

### Backend
* Base: axum, tokio, serde
* Database: postgresql/sqlite, diesel
* Build: Rust 1.89

## Project Structure
* Server-side code is written in Rust, located under the `/server` path.
* Front-end code is written in SolidJS/TypeScript, located under the `/front` path.

### Frontend
* `front/src/pages`: All pages for the application.
* `front/src/components`: Global components, including a `ui` subdirectory for generic, reusable UI elements.
* `front/src/service/`: Services for features like authentication and HTTP requests.
* `front/src/store`: Global state management (stores).

### Backend
* `server/migrations`: SQL migration files for SQLite and PostgreSQL.
* `server/src/database`: Database connection, entity definitions, and CRUD (Create, Read, Update, Delete) operations.
* `server/src/schema`: Database schema, auto-generated by Diesel from migrations.
* `server/src/controller`: API endpoint declarations and implementations.
* `server/src/utils`: Utility modules for features like authentication, billing calculation, and access limit checks.
* `server/src/service`: Business logic services, including an in-memory cache (`app_state`), request/response transformation for different AI services, and a Vertex AI token issuer.


## Use Cargo to Manage the Project
This project uses `cargo xtask` for project management.

| Command                 | Purpose                                     |
| ----------------------- | ------------------------------------------- |
| `cargo xtask dev-backend` | Start backend server                        |
| `cargo xtask dev-front`   | Start frontend development server           |
| `cargo xtask dev`         | Start both backend and frontend             |
| `cargo xtask test`        | Run tests for the backend                   |

## Best Practices

* Be conservative with changes to existing code, but use modern approaches for new features.
* Always add tests for new functionality.
* Use proper error handling and logging.
